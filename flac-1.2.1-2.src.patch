diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/flac-1.2.1/doc/html/Makefile.am src/flac-1.2.1/doc/html/Makefile.am
--- origsrc/flac-1.2.1/doc/html/Makefile.am	2007-09-16 14:14:01.000000000 -0500
+++ src/flac-1.2.1/doc/html/Makefile.am	2007-09-16 23:01:36.437500000 -0500
@@ -73,7 +73,7 @@
 # handle 'api/' specially:
 install-data-local:
 	$(mkinstalldirs) $(DESTDIR)$(docdir)/api
-	(cd api && $(INSTALL_DATA) * $(DESTDIR)$(docdir)/api)
+	(cd $(srcdir)/api && $(INSTALL_DATA) * $(DESTDIR)$(docdir)/api)
 uninstall-local:
 	rm -rf $(DESTDIR)$(docdir)/api
 maintainer-clean-local:
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/flac-1.2.1/src/libFLAC/Makefile.am src/flac-1.2.1/src/libFLAC/Makefile.am
--- origsrc/flac-1.2.1/src/libFLAC/Makefile.am	2007-09-14 16:06:17.000000000 -0500
+++ src/flac-1.2.1/src/libFLAC/Makefile.am	2007-09-16 23:01:36.437500000 -0500
@@ -96,7 +96,7 @@
 	ogg_mapping.c
 endif
 # see 'http://www.gnu.org/software/libtool/manual.html#Libtool-versioning' for numbering convention
-libFLAC_la_LDFLAGS = -version-info 10:0:2 -lm $(LOCAL_EXTRA_LDFLAGS)
+libFLAC_la_LDFLAGS = -version-info 10:0:2 -no-undefined -lm $(LOCAL_EXTRA_LDFLAGS)
 libFLAC_la_SOURCES = \
 	bitmath.c \
 	bitreader.c \
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/flac-1.2.1/src/libFLAC++/Makefile.am src/flac-1.2.1/src/libFLAC++/Makefile.am
--- origsrc/flac-1.2.1/src/libFLAC++/Makefile.am	2007-09-14 16:06:10.000000000 -0500
+++ src/flac-1.2.1/src/libFLAC++/Makefile.am	2007-09-16 23:01:36.484375000 -0500
@@ -46,7 +46,7 @@
 	libFLAC++.m4
 
 # see 'http://www.gnu.org/software/libtool/manual.html#Libtool-versioning' for numbering convention
-libFLAC___la_LDFLAGS = -version-info 8:0:2
+libFLAC___la_LDFLAGS = -version-info 8:0:2 -no-undefined
 libFLAC___la_LIBADD = ../libFLAC/libFLAC.la
 
 libFLAC___la_SOURCES = \
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/flac-1.2.1/src/plugin_xmms/Makefile.am src/flac-1.2.1/src/plugin_xmms/Makefile.am
--- origsrc/flac-1.2.1/src/plugin_xmms/Makefile.am	2007-02-02 00:25:04.000000000 -0600
+++ src/flac-1.2.1/src/plugin_xmms/Makefile.am	2007-09-16 23:01:36.546875000 -0500
@@ -67,4 +67,4 @@
 	@OGG_LIBS@ \
 	@XMMS_LIBS@ \
 	@LIBICONV@
-libxmms_flac_la_LDFLAGS = -module -avoid-version
+libxmms_flac_la_LDFLAGS = -module -avoid-version -no-undefined
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/flac-1.2.1/src/plugin_xmms/http.c src/flac-1.2.1/src/plugin_xmms/http.c
--- origsrc/flac-1.2.1/src/plugin_xmms/http.c	2007-09-11 12:18:33.000000000 -0500
+++ src/flac-1.2.1/src/plugin_xmms/http.c	2007-09-16 23:01:36.640625000 -0500
@@ -46,7 +46,7 @@
 #include "plugin.h"
 
 /* on FreeBSD we get socklen_t from <sys/socket.h> */
-#if (!defined HAVE_SOCKLEN_T) && !defined(__FreeBSD__)
+#if (!defined HAVE_SOCKLEN_T) && !defined(__FreeBSD__) && !defined(__CYGWIN__)
 typedef unsigned int socklen_t;
 #endif
 
diff -urN -x CYGWIN-PATCHES -x 'aclocal.m4*' -x autom4te.cache -x config.cache -x config.log -x config.status -x config.h -x config.h.in -x ABOUT-NLS -x Makefile.in.in -x Makevars.template -x '*SlackBuild*' -x '*.egg-info' -x '*.class' -x '*.pyc' -x '*.mo' -x '*.gmo' -x '*.orig' -x '*.rej' -x '*.spec' -x '*.temp' -x '*~' -x '*.stackdump' -x COPYING -x INSTALL -x compile -x config-ml.in -x config.guess -x config.sub -x depcomp -x elisp-comp -x install-sh -x ltmain.sh -x mdate-sh -x missing -x mkinstalldirs -x py-compile -x symlink-tree -x texinfo.tex -x ylwrap -x config.rpath -x Makefile.in -x makefile.in -x configure -x omf.make -x xmldocs.make -x gnome-doc-utils.make -x gnome-doc-utils.m4 -x intltool.m4 -x intltool-extract -x intltool-extract.in -x intltool-merge -x intltool-merge.in -x intltool-update -x intltool-update.in origsrc/flac-1.2.1/test/test_grabbag.sh src/flac-1.2.1/test/test_grabbag.sh
--- origsrc/flac-1.2.1/test/test_grabbag.sh	2007-06-16 14:58:29.000000000 -0500
+++ src/flac-1.2.1/test/test_grabbag.sh	2007-09-16 23:01:36.656250000 -0500
@@ -74,7 +74,7 @@
 ########################################################################
 
 log=picture.log
-picture_dir=pictures
+picture_dir=$srcdir/pictures
 
 echo "Running test_picture..."
 
@@ -83,9 +83,9 @@
 run_test_picture $picture_dir >> $log 2>&1
 
 if [ $is_win = yes ] ; then
-	diff -w picture.ok $log > picture.diff || die "Error: .log file does not match .ok file, see picture.diff"
+	diff -w $srcdir/picture.ok $log > picture.diff || die "Error: .log file does not match .ok file, see picture.diff"
 else
-	diff picture.ok $log > picture.diff || die "Error: .log file does not match .ok file, see picture.diff"
+	diff $srcdir/picture.ok $log > picture.diff || die "Error: .log file does not match .ok file, see picture.diff"
 fi
 
 echo "PASSED (results are in $log)"
